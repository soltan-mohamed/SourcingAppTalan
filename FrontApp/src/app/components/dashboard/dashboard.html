<div class="dashboard-container">
  <!-- Page Header -->
  <div class="page-header">
    <div class="header-content">
      <h1 class="page-title">Dashboard</h1>
      <p class="page-subtitle">Welcome to your recruitment dashboard</p>
    </div>
  </div>

  <!-- Main Content -->
  <div class="dashboard-content">
    
    <!-- Left Section - Today's Interviews -->
    <div class="dashboard-left">
      <div class="interviews-card">
        <div class="card-header">
          <div class="header-icon">
            <span class="material-symbols-outlined">schedule</span>
          </div>
          <div class="header-text">
            <h2>My Interviews</h2>
            <p>Today's scheduled interviews</p>
          </div>
        </div>
        
        <div class="card-content">
          <!-- Loading State -->
          <div *ngIf="isLoading" class="loading-state">
            <div class="loading-spinner">
              <svg class="spinner" viewBox="0 0 24 24">
                <circle class="spinner-circle" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"></circle>
                <path class="spinner-path" fill="currentColor"
                    d="M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"></path>
              </svg>
            </div>
            <span class="loading-text">Loading interviews...</span>
          </div>
          
          <!-- Error State -->
          <div *ngIf="error && !isLoading" class="empty-state">
            <div class="empty-icon">
              <span class="material-symbols-outlined">error</span>
            </div>
            <h3>Error Loading Interviews</h3>
            <p>{{ error }}</p>
          </div>
          
          <!-- No Interviews -->
          <div *ngIf="!isLoading && !error && todayInterviews.length === 0" class="empty-state">
            <div class="empty-icon">
              <span class="material-symbols-outlined">event_available</span>
            </div>
            <h3>No Interviews Today</h3>
            <p>No interviews scheduled for today</p>
          </div>
          
          <!-- Interviews List -->
          <div *ngIf="!isLoading && !error && todayInterviews.length > 0" class="interview-list">
            <div *ngFor="let interview of todayInterviews" 
                (click)="openCandidateHistory(interview)"
                class="interview-card"
                [class.is-expanded]="interview.isExpanded"
                [ngClass]="'interview-card-' + (interview.type.toLowerCase() || 'default')">
              
              <!-- Candidate Name and Type -->
              <div class="interview-header">
                <h3 class="candidate-name">
                  {{ interview.fullName || 'Unknown Candidate' }}
                </h3>
                <span class="interview-type-badge" 
                      [ngClass]="'badge-' + (interview.type.toLowerCase() || 'default')">
                  {{ interview.type }}
                </span>
                 <button class="expand-button" (click)="toggleInterview(interview, $event)">
                  <span class="material-symbols-outlined">expand_more</span>
                </button>
              </div>
              
               <div class="interview-details-wrapper" (click)="openCandidateHistory(interview)">
                <div *ngIf="interview.isExpanded" class="interview-details">
                  <div class="interview-detail">
                    <span class="material-symbols-outlined">schedule</span>
                    <span class="detail-text">{{ getTimeRange(interview.date) }}</span>
                  </div>

                  <div class="interview-detail">
                    <span class="material-symbols-outlined">work</span>
                    <span class="detail-text">{{ interview.position || 'Position not specified' }}</span>
                  </div>

                  <div class="interview-detail">
                    <span class="material-symbols-outlined">location_on</span>
                    <span class="detail-text"
                          [ngClass]="{
                            'location-pending': interview.lieuEvaluation === 'Remote/Virtual' || interview.lieuEvaluation === 'Location TBD',
                            'location-confirmed': interview.lieuEvaluation !== 'Remote/Virtual' && interview.lieuEvaluation !== 'Location TBD'
                          }">
                      {{ interview.lieuEvaluation }}
                      <span *ngIf="interview.lieuEvaluation === 'Remote/Virtual'" class="location-badge remote">üìπ</span>
                      <span *ngIf="interview.lieuEvaluation === 'Location TBD'" class="location-badge pending">üìç</span>
                    </span>
                  </div>

                  <div class="interview-detail">
                    <span class="material-symbols-outlined">person</span>
                    <span class="detail-text">{{ interview.evaluatorName || 'Not Assigned' }}</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Right Section - To Review Table -->
    <div class="dashboard-right">

      <!-- To Review Card -->
      <div class="review-card">
        <div class="card-header">
          <div class="header-icon">
            <span class="material-symbols-outlined">pending_actions</span>
          </div>
          <div class="header-text">
            <h2>To Review</h2>
            <p>Candidates requiring your attention</p>
          </div>
        </div>

        <div class="card-content">
          <!-- Table -->
          <div class="table-container" *ngIf="candidates.length !== 0 && !isLoading">
            <table mat-table [dataSource]="candidates" class="candidates-table">
              
              <ng-container matColumnDef="fullName">
                <th mat-header-cell *matHeaderCellDef class="table-header">Full Name</th>
                <td mat-cell *matCellDef="let candidate" class="table-cell">{{candidate.fullName}}</td>
              </ng-container>

              <ng-container matColumnDef="status">
                <th mat-header-cell *matHeaderCellDef class="table-header">Status</th>
                <td mat-cell *matCellDef="let candidate" class="table-cell">
                  @switch (candidate.statut) {
                    @case ('IN_PROGRESS') {
                      <span class="status-badge status-in-progress">{{ candidate.statut }}</span>
                    }
                    @case ("CONTACTED") {
                      <span class="status-badge status-contacted">{{ candidate.statut }}</span>
                    }
                  }
                </td>
              </ng-container>

              <ng-container matColumnDef="evaluationType">
                <th mat-header-cell *matHeaderCellDef class="table-header">Interview</th>
                <td mat-cell *matCellDef="let candidate" class="table-cell">{{candidate.evaluationType}}</td>
              </ng-container>

              <ng-container matColumnDef="date">
                <th mat-header-cell *matHeaderCellDef class="table-header">Date</th>
                <td mat-cell *matCellDef="let candidate" class="table-cell">{{candidate.date | date:'dd/MM/yyyy'}}</td>
              </ng-container>

              <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
              <tr mat-row *matRowDef="let row; columns: displayedColumns;" 
                  class="table-row"
                  (click)="openHistory(row)"></tr>
            </table>
          </div>

          <!-- Empty State -->
          <div class="empty-state" *ngIf="candidates.length === 0 && !isLoading">
            <div class="empty-icon">
              <span class="material-symbols-outlined">search_off</span>
            </div>
            <h3>No Reviews Pending</h3>
            <p>All candidates have been reviewed. Great job!</p>
          </div>

          <!-- Loading State -->
          <div class="loading-state" *ngIf="isLoading">
            <div class="loading-spinner">
              <svg class="spinner" viewBox="0 0 24 24">
                <circle class="spinner-circle" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"></circle>
                <path class="spinner-path" fill="currentColor"
                    d="M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"></path>
              </svg>
            </div>
            <span class="loading-text">Loading candidates...</span>
          </div>
        </div>
      </div>

     
    </div>
  </div>
</div>
